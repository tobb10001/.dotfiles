# vim: ft=yaml.ansible
- name: Bootstrap development environment
  hosts: localhost

  tasks:
    - name: Create some directories.
      ansible.builtin.file:
        path: "{{ item }}"
        state: directory
        mode: '0755'
      loop:
        - ~/.local/bin
        - ~/.local/share

    - name: Install software
      ansible.builtin.include_tasks:
        file: ansible/software.yml

    - name: Update tldr cache
      become: false
      ansible.builtin.command: tldr --update
      register: tldr_updated
      changed_when: tldr_updated.rc != 0

    - name: Stow
      ansible.builtin.include_tasks:
        file: ansible/stow.yml

    - name: Install JetBrains Mono NerdFont
      block:
        - name: Create JetBrains Mono target directory.
          become: true
          ansible.builtin.file:
            path: /usr/share/fonts/JetBrainsMonoNerd/
            state: directory
            mode: '0755'
        - name: Download JetBrains Mono NerdFont
          become: true
          ansible.builtin.unarchive:
            src: https://github.com/ryanoasis/nerd-fonts/releases/download/v3.0.2/JetBrainsMono.zip
            dest: /usr/share/fonts/JetBrainsMonoNerd/
            exclude:
              - OFL.txt
              - readme.md
            remote_src: true
            creates: /usr/share/fonts/JetBrainsMonoNerd/JetBrainsMonoNerdFont-Regular.ttf
        - name: Update fonts cache
          become: true
          ansible.builtin.command: fc-cache --force --verbose
